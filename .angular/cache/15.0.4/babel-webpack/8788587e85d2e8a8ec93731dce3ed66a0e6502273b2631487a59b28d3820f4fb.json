{"ast":null,"code":"import { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nexport function groupBy(keySelector, elementSelector, durationSelector, subjectSelector) {\n  return source => source.lift(new GroupByOperator(keySelector, elementSelector, durationSelector, subjectSelector));\n}\n\nclass GroupByOperator {\n  constructor(keySelector, elementSelector, durationSelector, subjectSelector) {\n    this.keySelector = keySelector;\n    this.elementSelector = elementSelector;\n    this.durationSelector = durationSelector;\n    this.subjectSelector = subjectSelector;\n  }\n\n  call(subscriber, source) {\n    return source.subscribe(new GroupBySubscriber(subscriber, this.keySelector, this.elementSelector, this.durationSelector, this.subjectSelector));\n  }\n\n}\n\nclass GroupBySubscriber extends Subscriber {\n  constructor(destination, keySelector, elementSelector, durationSelector, subjectSelector) {\n    super(destination);\n    this.keySelector = keySelector;\n    this.elementSelector = elementSelector;\n    this.durationSelector = durationSelector;\n    this.subjectSelector = subjectSelector;\n    this.groups = null;\n    this.attemptedToUnsubscribe = false;\n    this.count = 0;\n  }\n\n  _next(value) {\n    let key;\n\n    try {\n      key = this.keySelector(value);\n    } catch (err) {\n      this.error(err);\n      return;\n    }\n\n    this._group(value, key);\n  }\n\n  _group(value, key) {\n    let groups = this.groups;\n\n    if (!groups) {\n      groups = this.groups = new Map();\n    }\n\n    let group = groups.get(key);\n    let element;\n\n    if (this.elementSelector) {\n      try {\n        element = this.elementSelector(value);\n      } catch (err) {\n        this.error(err);\n      }\n    } else {\n      element = value;\n    }\n\n    if (!group) {\n      group = this.subjectSelector ? this.subjectSelector() : new Subject();\n      groups.set(key, group);\n      const groupedObservable = new GroupedObservable(key, group, this);\n      this.destination.next(groupedObservable);\n\n      if (this.durationSelector) {\n        let duration;\n\n        try {\n          duration = this.durationSelector(new GroupedObservable(key, group));\n        } catch (err) {\n          this.error(err);\n          return;\n        }\n\n        this.add(duration.subscribe(new GroupDurationSubscriber(key, group, this)));\n      }\n    }\n\n    if (!group.closed) {\n      group.next(element);\n    }\n  }\n\n  _error(err) {\n    const groups = this.groups;\n\n    if (groups) {\n      groups.forEach((group, key) => {\n        group.error(err);\n      });\n      groups.clear();\n    }\n\n    this.destination.error(err);\n  }\n\n  _complete() {\n    const groups = this.groups;\n\n    if (groups) {\n      groups.forEach((group, key) => {\n        group.complete();\n      });\n      groups.clear();\n    }\n\n    this.destination.complete();\n  }\n\n  removeGroup(key) {\n    this.groups.delete(key);\n  }\n\n  unsubscribe() {\n    if (!this.closed) {\n      this.attemptedToUnsubscribe = true;\n\n      if (this.count === 0) {\n        super.unsubscribe();\n      }\n    }\n  }\n\n}\n\nclass GroupDurationSubscriber extends Subscriber {\n  constructor(key, group, parent) {\n    super(group);\n    this.key = key;\n    this.group = group;\n    this.parent = parent;\n  }\n\n  _next(value) {\n    this.complete();\n  }\n\n  _unsubscribe() {\n    const {\n      parent,\n      key\n    } = this;\n    this.key = this.parent = null;\n\n    if (parent) {\n      parent.removeGroup(key);\n    }\n  }\n\n}\n\nexport class GroupedObservable extends Observable {\n  constructor(key, groupSubject, refCountSubscription) {\n    super();\n    this.key = key;\n    this.groupSubject = groupSubject;\n    this.refCountSubscription = refCountSubscription;\n  }\n\n  _subscribe(subscriber) {\n    const subscription = new Subscription();\n    const {\n      refCountSubscription,\n      groupSubject\n    } = this;\n\n    if (refCountSubscription && !refCountSubscription.closed) {\n      subscription.add(new InnerRefCountSubscription(refCountSubscription));\n    }\n\n    subscription.add(groupSubject.subscribe(subscriber));\n    return subscription;\n  }\n\n}\n\nclass InnerRefCountSubscription extends Subscription {\n  constructor(parent) {\n    super();\n    this.parent = parent;\n    parent.count++;\n  }\n\n  unsubscribe() {\n    const parent = this.parent;\n\n    if (!parent.closed && !this.closed) {\n      super.unsubscribe();\n      parent.count -= 1;\n\n      if (parent.count === 0 && parent.attemptedToUnsubscribe) {\n        parent.unsubscribe();\n      }\n    }\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Morgan/Desktop/DEV/angular/mbo-ez-angular-ez-http-client/node_modules/rxjs/_esm2015/internal/operators/groupBy.js"],"names":["Subscriber","Subscription","Observable","Subject","groupBy","keySelector","elementSelector","durationSelector","subjectSelector","source","lift","GroupByOperator","constructor","call","subscriber","subscribe","GroupBySubscriber","destination","groups","attemptedToUnsubscribe","count","_next","value","key","err","error","_group","Map","group","get","element","set","groupedObservable","GroupedObservable","next","duration","add","GroupDurationSubscriber","closed","_error","forEach","clear","_complete","complete","removeGroup","delete","unsubscribe","parent","_unsubscribe","groupSubject","refCountSubscription","_subscribe","subscription","InnerRefCountSubscription"],"mappings":"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","sourcesContent":["import { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nexport function groupBy(keySelector, elementSelector, durationSelector, subjectSelector) {\n    return (source) => source.lift(new GroupByOperator(keySelector, elementSelector, durationSelector, subjectSelector));\n}\nclass GroupByOperator {\n    constructor(keySelector, elementSelector, durationSelector, subjectSelector) {\n        this.keySelector = keySelector;\n        this.elementSelector = elementSelector;\n        this.durationSelector = durationSelector;\n        this.subjectSelector = subjectSelector;\n    }\n    call(subscriber, source) {\n        return source.subscribe(new GroupBySubscriber(subscriber, this.keySelector, this.elementSelector, this.durationSelector, this.subjectSelector));\n    }\n}\nclass GroupBySubscriber extends Subscriber {\n    constructor(destination, keySelector, elementSelector, durationSelector, subjectSelector) {\n        super(destination);\n        this.keySelector = keySelector;\n        this.elementSelector = elementSelector;\n        this.durationSelector = durationSelector;\n        this.subjectSelector = subjectSelector;\n        this.groups = null;\n        this.attemptedToUnsubscribe = false;\n        this.count = 0;\n    }\n    _next(value) {\n        let key;\n        try {\n            key = this.keySelector(value);\n        }\n        catch (err) {\n            this.error(err);\n            return;\n        }\n        this._group(value, key);\n    }\n    _group(value, key) {\n        let groups = this.groups;\n        if (!groups) {\n            groups = this.groups = new Map();\n        }\n        let group = groups.get(key);\n        let element;\n        if (this.elementSelector) {\n            try {\n                element = this.elementSelector(value);\n            }\n            catch (err) {\n                this.error(err);\n            }\n        }\n        else {\n            element = value;\n        }\n        if (!group) {\n            group = (this.subjectSelector ? this.subjectSelector() : new Subject());\n            groups.set(key, group);\n            const groupedObservable = new GroupedObservable(key, group, this);\n            this.destination.next(groupedObservable);\n            if (this.durationSelector) {\n                let duration;\n                try {\n                    duration = this.durationSelector(new GroupedObservable(key, group));\n                }\n                catch (err) {\n                    this.error(err);\n                    return;\n                }\n                this.add(duration.subscribe(new GroupDurationSubscriber(key, group, this)));\n            }\n        }\n        if (!group.closed) {\n            group.next(element);\n        }\n    }\n    _error(err) {\n        const groups = this.groups;\n        if (groups) {\n            groups.forEach((group, key) => {\n                group.error(err);\n            });\n            groups.clear();\n        }\n        this.destination.error(err);\n    }\n    _complete() {\n        const groups = this.groups;\n        if (groups) {\n            groups.forEach((group, key) => {\n                group.complete();\n            });\n            groups.clear();\n        }\n        this.destination.complete();\n    }\n    removeGroup(key) {\n        this.groups.delete(key);\n    }\n    unsubscribe() {\n        if (!this.closed) {\n            this.attemptedToUnsubscribe = true;\n            if (this.count === 0) {\n                super.unsubscribe();\n            }\n        }\n    }\n}\nclass GroupDurationSubscriber extends Subscriber {\n    constructor(key, group, parent) {\n        super(group);\n        this.key = key;\n        this.group = group;\n        this.parent = parent;\n    }\n    _next(value) {\n        this.complete();\n    }\n    _unsubscribe() {\n        const { parent, key } = this;\n        this.key = this.parent = null;\n        if (parent) {\n            parent.removeGroup(key);\n        }\n    }\n}\nexport class GroupedObservable extends Observable {\n    constructor(key, groupSubject, refCountSubscription) {\n        super();\n        this.key = key;\n        this.groupSubject = groupSubject;\n        this.refCountSubscription = refCountSubscription;\n    }\n    _subscribe(subscriber) {\n        const subscription = new Subscription();\n        const { refCountSubscription, groupSubject } = this;\n        if (refCountSubscription && !refCountSubscription.closed) {\n            subscription.add(new InnerRefCountSubscription(refCountSubscription));\n        }\n        subscription.add(groupSubject.subscribe(subscriber));\n        return subscription;\n    }\n}\nclass InnerRefCountSubscription extends Subscription {\n    constructor(parent) {\n        super();\n        this.parent = parent;\n        parent.count++;\n    }\n    unsubscribe() {\n        const parent = this.parent;\n        if (!parent.closed && !this.closed) {\n            super.unsubscribe();\n            parent.count -= 1;\n            if (parent.count === 0 && parent.attemptedToUnsubscribe) {\n                parent.unsubscribe();\n            }\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}